<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/man-astronaut_1f468-200d-1f680.png">
    <link href="https://fonts.googleapis.com/css?family=Baloo+2&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="focus.css">
    <title>Focus</title>
</head>
<body>
    <div id="centerContainer">
        <select class="focus" id="selectGoal">
            <option disabled selected style="display:none;">Select a duration</option>
            <option value="15">15 minutes</option>
            <option value="25">25 minutes</option>
            <option value="35">35 minutes</option>
        </select>
        <button class="focus" id="startButton">Start focusing 👨‍🚀️</button>
    </div>
    <script>
        const now = () => new Date();

        const updateIcon = (url) => {
            let link = document.querySelector("link[rel*='icon']");
            link.type = 'image/x-icon';
            link.rel = 'shortcut icon';
            link.href = url;
            document.getElementsByTagName('head')[0].appendChild(link);
        }


        const button = document.getElementById('startButton');
        button.addEventListener('click', () => {
            const gs = document.getElementById('selectGoal');
            const goal = parseInt(gs.options[gs.selectedIndex].value);

            if (goal) {
                const container = document.getElementById('centerContainer');
                container.innerHTML = '';
                const h1 = document.createElement('h1');
                h1.innerHTML = 'Taking of 🚀️';
                container.appendChild(h1);
                const start = now();

                updateIcon('https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/rocket_1f680.png');
                const update = () => {
                    let elapsed = parseInt((now() - start) / 1000);
                    const minutes = parseInt(elapsed / 60);
                    const remaining = goal - minutes;
                    console.log('remaining', remaining);
                    h1.innerHTML =  remaining;
                    document.title = `${remaining}'`;
                    if (!remaining > 0) {
                        h1.innerHTML =  '👏🏻 Congrats 👏🏻';
                        document.title = 'Congrats!';

                        updateIcon('https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/google/241/full-moon_1f315.png');
                        clearInterval(t);
                    }
                }

                let t = setInterval(update, 5000);
            }
            else {
                console.log('please select a duration');
            }

        });
    </script>
</body>
</html>
